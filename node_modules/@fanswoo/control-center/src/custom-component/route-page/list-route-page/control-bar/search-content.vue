<template>
  <span class="search-content" ff-list-searchbox>
    <!-- <template 
            v-for="(field, key) in [1,2,3,4,5]"
        >
            <b-button variant="light" :key="key">
                工作狀態：未處理
                <b-badge variant="secondary">× <span class="sr-only">unread messages</span></b-badge>
            </b-button>
        </template> -->
    <template v-for="(field, index) in searchSettingFields" :key="index">
      <b-button
        variant="light"
        v-if="
          field.value &&
          field.type !== 'InputHidden' &&
          field.value !== getFieldSelectedValue(field)
        "
        @click="clearSearchContentValue(field)"
      >
        <template v-if="field.type == 'InputSelect'">
          {{ field.title }} :
          <template v-for="option in field.inputOptions">
            <template v-if="option.value == field.value">
              {{ option.text }}
            </template>
          </template>
        </template>
        <template v-else-if="field.type == 'InputClassTag'">
          {{ field.title }} : {{ field.value }}
        </template>
        <template v-else> {{ field.title }} : {{ field.value }} </template>
        <b-badge v-if="field.type !== 'display'" variant="secondary"
          >×<span class="sr-only">unread messages</span></b-badge
        >
      </b-button>
    </template>
  </span>
</template>

<script>
export default {
  props: {
    searchSettingFields: {
      type: Object,
      default: function () {
        return {};
      },
    },
  },
  data: () => {
    return {};
  },
  // watch: {
  //     searchSettingFields(value){
  //         console.log(value);
  //     }
  // },
  methods: {
    clearSearchContentValue: function (field) {
      let value = null;

      if (field.type == 'InputHidden') {
        return false;
      }

      if (field.type == 'InputSelect') {
        let fieldSelectedValue = this.getFieldSelectedValue(field);

        if (field.value == fieldSelectedValue) {
          return false;
        }

        value = fieldSelectedValue;
      }

      this.changeResult({
        inputName: field.inputName,
        value: value,
      });

      return true;
    },
    getFieldSelectedValue(field) {
      if (field.type == 'InputSelect') {
        for (let optionKey in field.inputOptions) {
          if (field.inputOptions[optionKey].selected == true) {
            return field.inputOptions[optionKey].value;
          }
        }
      }

      return null;
    },
    changeResult: function (field) {
      for (var key in this.searchSettingFields) {
        if (this.searchSettingFields[key].inputName == field.inputName) {
          this.searchSettingFields[key].value = field.value;
          this.$emit('changeResult', {
            key: key,
            text: this.searchSettingFields[key].value,
            value: this.searchSettingFields[key].value,
          });
        }
      }
    },
  },
  updated() {},
};
</script>
