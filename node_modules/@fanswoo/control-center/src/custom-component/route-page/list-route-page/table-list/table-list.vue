<template>
  <div>
    <div
      v-show="scrollFixed"
      :class="{ 'table-content': true, 'table-head-fixed': true }"
      :style="{ top: controlBarHeight + 'px' }"
    >
      <b-table-simple hover responsive>
        <TableHeadContent
          :batchSelectOptions="batchSelectOptions"
          :ControlCenter="ControlCenter"
          :ORMs="ORMs"
          :ORMCheckedIds="ORMCheckedIds"
          :scrollFixed="scrollFixed"
        ></TableHeadContent>
        <TableBodyContent
          :batchSelectOptions="batchSelectOptions"
          :ControlCenter="ControlCenter"
          :ORMs="ORMs"
          :ORMCheckedIds="ORMCheckedIds"
          :onlyTrashed="onlyTrashed"
          :scrollFixed="scrollFixed"
          :hideIds="true"
          @onORMCollectionUpdate="onORMCollectionUpdate"
        ></TableBodyContent>
      </b-table-simple>
    </div>
    <div :class="{ 'table-content': true, fixed: scrollFixed }">
      <b-table-simple hover responsive>
        <TableHeadContent
          :batchSelectOptions="batchSelectOptions"
          :ControlCenter="ControlCenter"
          :ORMs="ORMs"
          :ORMCheckedIds="ORMCheckedIds"
          :scrollFixed="scrollFixed"
        ></TableHeadContent>
        <TableBodyContent
          :batchSelectOptions="batchSelectOptions"
          :ControlCenter="ControlCenter"
          :ORMs="ORMs"
          :ORMCheckedIds="ORMCheckedIds"
          :onlyTrashed="onlyTrashed"
          :scrollFixed="scrollFixed"
          @onORMCollectionUpdate="onORMCollectionUpdate"
        ></TableBodyContent>
      </b-table-simple>
    </div>
    <SearchStatus
      :ORMs="ORMs"
      :searching="searching"
      :canSearchMore="canSearchMore"
      @onORMCollectionPush="onORMCollectionPush"
    ></SearchStatus>
  </div>
</template>

<script setup lang="ts">
import TableHeadContent from '@fanswoo/control-center/custom-component/route-page/list-route-page/table-list/table-head-content.vue';
import TableBodyContent from '@fanswoo/control-center/custom-component/route-page/list-route-page/table-list/table-body-content.vue';
import SearchStatus from '@fanswoo/control-center/custom-component/route-page/list-route-page/search-status.vue';

// Define props
const props = defineProps({
  scrollFixed: {
    type: Boolean,
    default: false,
  },
  controlBarHeight: {
    type: Number,
    default: 0,
  },
  batchSelectOptions: {
    type: Object,
    default: () => ({}),
  },
  ControlCenter: {
    type: Object,
    default: () => ({}),
  },
  ORMs: {
    type: Array,
    default: () => ([]),
  },
  ORMCheckedIds: {
    type: Array,
    default: () => ([]),
  },
  onlyTrashed: {
    type: Boolean,
    default: false,
  },
  searching: {
    type: Boolean,
    default: false,
  },
  canSearchMore: {
    type: String,
    default: '',
  },
});

// Component emits
const emit = defineEmits(['onORMCollectionPush', 'onORMCollectionUpdate']);

// Methods to emit events
const onORMCollectionPush = () => {
  emit('onORMCollectionPush');
};

const onORMCollectionUpdate = (payload) => {
  emit('onORMCollectionUpdate', payload);
};
</script>

