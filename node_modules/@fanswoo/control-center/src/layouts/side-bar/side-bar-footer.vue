<template>
  <div class="side-bar-footer" v-if="Object.keys(languages).length > 1">
    <div class="footer-item language" @change="changeLocale($event)">
      <b>語言切換：</b>
      <select>
        <option
          v-for="(item, key) in languages"
          :value="key"
          :selected="key == currentLocale"
          :key="key"
        >
          {{ item }}
        </option>
      </select>
    </div>
  </div>
</template>

<script lang="ts">
import { defineComponent, ref, getCurrentInstance } from 'vue';
import { useStore } from '@/control-center/store/control-center-store';
const store = useStore();

export default defineComponent({
  setup() {
    const languages = ref({});
    const language = store.state.language;
    const currentLocale = store.state.currentLocale;

    function changeLocale(event: Event) {
      window.location.href = `api/lang/${event.target.value}`;
    }

    return {
      languages,
      language,
      currentLocale,
      changeLocale
    };
  },
  mounted() {
    if (this.language) {
      this.languages = JSON.parse(JSON.stringify(this.language));
    }
  }
});
</script>
