<template>
    <div>
        <li :style="paddingLeftStyle(order)" class="border-bottom">
            <div class="d-flex align-items-center my-2">
                <input 
                    type="checkbox"
                    :disabled="locked"
                    :checked="category.checked"
                    :value="category.id"
                    @click="categoryCheckedChangeHandler($event)"
                    :id="category.id"
                    class="cursor-pointer"
                >
                <label 
                  class="my-0 h6 cursor-pointer" 
                  :style="marginLeftStyle" 
                  :for="category.id"
                >{{category.name}}</label>
            </div>
        </li>
        <template v-if="category.children && category.children.length > 0">
            <category-list
                v-for="(subCategory) in category.children"
                :uncheckable="!category.checked"
                :category="subCategory"
                :key="subCategory.id"
                :order="order + 1"
                :locked="locked"
            ></category-list>
        </template>
    </div>
</template>

<script>
export default {
  name: "category-list",
  props: {
    category: Object,
    order: Number,
    uncheckable: Boolean,
    locked: Boolean
  },
  watch: {
    "category.checked"(value) {
      if (this.category.children && this.category.children.length > 0) {
        for (let child of this.category.children) {
          child.checked = value;
        }
      }
    }
  },
  data() {
    return {
      marginLeftStyle: {
        marginLeft: 5 + "px"
      }
    };
  },
  methods: {
    paddingLeftStyle(n) {
      return {
        paddingLeft: n * 13 + 10 + "px"
      };
    },
    categoryCheckedChangeHandler(event) {
      if (!this.uncheckable && !this.category.checked === false) {
        event.preventDefault();
        return false;
      }

      this.category.checked = !this.category.checked;
    }
  },
  computed: {},
  updated() {}
};
</script>

<style scoped lang="css">
ul {
  padding: 0;
  padding-left: 13px;
  list-style: none;
}

.border-bottom {
  border-bottom: 1px solid #ccc;
}

.cursor-pointer {
  cursor: pointer;
}
</style>