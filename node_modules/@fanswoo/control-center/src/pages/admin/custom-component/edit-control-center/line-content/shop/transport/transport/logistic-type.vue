<template>
  <div>
    <LineContent title="物流類型">
      <select
        class="logistic-type"
        name="logisticType"
        @change="changeTransport($event)"
      >
        <option
          v-for="(config, key) in cashierConfig"
          :key="config.name"
          :value="key"
          :data-lower="config.lower"
          :data-upper="config.upper"
          :selected="
            Transport.logisticType == key || currentTransportType == key
          "
        >
          {{ config.name }}
        </option>
      </select>
    </LineContent>
    <LineContent
      title="物流名稱"
      v-show="this.nameableTransports.includes(currentTransportType)"
    >
      <input
        type="text"
        name="name"
        placeholder="請填寫物流名稱"
        class="form-control"
        :value="Transport.name"
      />
    </LineContent>
    <LineContent title="物流金額下限">
      <input
        type="number"
        id="price-lower-limit"
        name="priceLowerLimit"
        placeholder="請填寫物流金額下限"
        class="form-control"
        :value="priceLowerLimit"
      />
      <p class="explanation">
        設定此物流的金額下限，若消費者訂單金額未滿此金額則前台將不顯示此物流方式(值為0表示不限制)
      </p>
    </LineContent>
    <LineContent title="物流金額上限">
      <input
        type="number"
        id="price-upper-limit"
        name="priceUpperLimit"
        placeholder="請填寫物流金額上限"
        class="form-control"
        :value="priceUpperLimit"
      />
      <p class="explanation">
        設定此物流的金額上限，若消費者訂單金額超過此金額則前台將不顯示此物流方式(值為0表示不限制)
      </p>
      <p class="explanation">
        請注意至少新增一種無限制金額上下限的物流方式，以免消費者在購物車無法選擇任何物流方式
      </p>
    </LineContent>
  </div>
</template>

<script>
import LineContent from '@fanswoo/control-center/custom-component/edit-control-center/line-content/base/line-content.vue';

export default {
  components: { LineContent },
  props: ['cashierConfig', 'nameableTransports', 'Transport'],
  data: () => {
    return {
      priceLowerLimit: 0,
      priceUpperLimit: 0,
      currentTransportType: '',
      // nameableTransports: [],
      // cashierConfig: [],
      // Transport: {}
    };
  },
  methods: {
    changeTransport(event) {
      if (event.target.options.selectedIndex > -1) {
        let lower =
          event.target.value == this.Transport.logisticType
            ? parseInt(this.Transport.priceLowerLimit)
            : parseInt(
                event.target.options[event.target.options.selectedIndex].dataset
                  .lower,
              );
        let upper =
          event.target.value == this.Transport.logisticType
            ? parseInt(this.Transport.priceUpperLimit)
            : parseInt(
                event.target.options[event.target.options.selectedIndex].dataset
                  .upper,
              );

        this.changeStatus(event.target.value, lower, upper);
      }
    },
    changeStatus(value, lower, upper) {
      this.currentTransportType = value;
      this.priceLowerLimit = lower;
      this.priceUpperLimit = upper;
    },
  },
  mounted() {
    this.priceLowerLimit = this.Transport.priceLowerLimit;
    this.priceUpperLimit = this.Transport.priceUpperLimit;

    for (let key of Object.keys(this.cashierConfig)) {
      this.currentTransportType = key;
      break;
    }

    // console.log(this.nameableTransports, this.currentTransportType);
    // this.nameableTransports = this.datas.nameableTransports;
    // this.cashierConfig = this.datas.cashierConfig;
    // this.Transport = this.datas.Transport;
  },
};
</script>
