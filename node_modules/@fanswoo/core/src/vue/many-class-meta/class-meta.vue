<template>
  <select
      :name="inputName ? inputName + '[]' : ''"
      v-model="selectedId"
      :class="classNames"
      @change="changeSelected"
  >
    <option v-if="layer === 0" value="">未選擇分類</option>
    <option
        v-for="(classTagTree, key) in classTagTreeChild"
        :value="key"
    >{{classTagTree.name}}</option>
  </select>
</template>

<script setup lang="ts">
import { inject, onMounted, onUpdated, ref } from "vue";

const props = defineProps({
  layer: Number,
  classTagTreeChild: Array,
  inputName: String
});

const selectedId = defineModel();

const emit = defineEmits(['changeSelected']);

const classNames = inject('classNames');

const changeSelected = () => {
  emit('changeSelected', {
    layer: props.layer,
    selectedId: selectedId.value
  });
};

const checkSelected = () => {
  let isSelected = false;
  for (let key in props.classTagTreeChild) {
    if (key == selectedId.value) {
      isSelected = true;
    }
  }
};

onMounted(() => {
  checkSelected();
});

onUpdated(() => {
  checkSelected();
});
</script>

<style lang="scss" scoped>
select {
  margin-bottom: 5px;
  margin-right: 5px;
}
</style>